<?php include __DIR__ . '/header.phtml'; ?>

<main class="bg-light">
    <!-- Barre de recherche en haut -->
    <section class="search-bar-section py-3">
        <div class="container-xxl">
            <form class="row g-2 align-items-end" id="searchForm" method="GET" action="covoiturages.php">
                <div class="col-12 col-lg-3">
                    <label class="form-label fw-semibold small" for="departure">
                        <i class="bi bi-geo-alt-fill text-success"></i> Départ
                    </label>
                    <input
                        class="form-control form-control-sm" 
                        type="text"
                        id="departure"
                        name="departure"
                        placeholder="Ville de départ"
                        value="<?= htmlspecialchars($_GET['departure'] ?? '') ?>"
                        required
                        autocomplete="off">
                </div>
        
                <div class="col-12 col-lg-3">
                    <label class="form-label fw-semibold small" for="destination">
                        <i class="bi bi-geo-alt text-success"></i> Destination
                    </label>
                    <input
                        class="form-control form-control-sm" 
                        type="text"
                        id="destination"
                        name="destination"
                        placeholder="Ville d'arrivée"
                        value="<?= htmlspecialchars($_GET['destination'] ?? '') ?>"
                        required
                        autocomplete="off">
                </div>

                <div class="col-12 col-lg-2">
                    <label class="form-label fw-semibold small" for="date">
                        <i class="bi bi-calendar-event text-success"></i> Date
                    </label>
                    <input
                        class="form-control form-control-sm" 
                        type="date"
                        id="date"
                        name="date"
                        value="<?= htmlspecialchars($_GET['date'] ?? '') ?>"
                        required>
                </div>
                <div class="col-12 col-lg-2">
                    <button type="submit" class="btn btn-search w-100 btn-sm">
                        <i class="bi bi-search"></i> Rechercher
                    </button>
                </div>
            </form>
        </div>
    </section>

    <!-- Contenu principal avec filtres et résultats -->
    <section class="results-section py-4">
        <div class="container-xxl">
            <div class="row g-4">
                <!-- Colonne des filtres (gauche) -->
                <aside class="col-12 col-lg-3">
                    <div class="filters-container">
                        <h3 class="fw-bold mb-4">
                            <i class="bi bi-funnel"></i> Filtres
                        </h3>
                        
                        <form id="filtersForm" method="GET" action="covoiturages.php">
                            <!-- Conserver les paramètres de recherche -->
                            <input type="hidden" name="departure" value="<?= htmlspecialchars($_GET['departure'] ?? '') ?>">
                            <input type="hidden" name="destination" value="<?= htmlspecialchars($_GET['destination'] ?? '') ?>">
                            <input type="hidden" name="date" value="<?= htmlspecialchars($_GET['date'] ?? '') ?>">
                            <input type="hidden" name="seats" value="<?= htmlspecialchars($_GET['seats'] ?? '1') ?>">
                            
                            <!-- Filtre Voyage écologique -->
                            <div class="filter-group mb-4">
                                <label class="form-label fw-semibold">
                                    <i class="bi bi-ev-front"></i> Voyage écologique
                                </label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="electric" name="electric" value="1"
                                        <?= isset($_GET['electric']) ? 'checked' : '' ?>>
                                    <label class="form-check-label" for="electric">
                                        Voiture électrique uniquement
                                    </label>
                                </div>
                            </div>

                            <!-- Filtre Prix maximum -->
                            <div class="filter-group mb-4">
                                <label class="form-label fw-semibold" for="max_price">
                                    <i class="bi bi-currency-euro"></i> Prix maximum
                                </label>
                                <div class="input-group input-group-sm">
                                    <input 
                                        type="number" 
                                        class="form-control" 
                                        id="max_price" 
                                        name="max_price"
                                        placeholder="Ex: 50"
                                        min="0"
                                        step="5"
                                        value="<?= htmlspecialchars($_GET['max_price'] ?? '') ?>">
                                    <span class="input-group-text">€</span>
                                </div>
                            </div>

                            <!-- Filtre Durée maximum -->
                            <div class="filter-group mb-4">
                                <label class="form-label fw-semibold" for="max_duration">
                                    <i class="bi bi-clock"></i> Durée maximum
                                </label>
                                <select class="form-select form-select-sm" id="max_duration" name="max_duration">
                                    <option value="">Peu importe</option>
                                    <option value="60" <?= ($_GET['max_duration'] ?? '') == '60' ? 'selected' : '' ?>>Moins d'1h</option>
                                    <option value="120" <?= ($_GET['max_duration'] ?? '') == '120' ? 'selected' : '' ?>>Moins de 2h</option>
                                    <option value="180" <?= ($_GET['max_duration'] ?? '') == '180' ? 'selected' : '' ?>>Moins de 3h</option>
                                    <option value="240" <?= ($_GET['max_duration'] ?? '') == '240' ? 'selected' : '' ?>>Moins de 4h</option>
                                </select>
                            </div>

                            <!-- Filtre Note minimale -->
                            <div class="filter-group mb-4">
                                <label class="form-label fw-semibold" for="min_rating">
                                    <i class="bi bi-star-fill"></i> Note minimale
                                </label>
                                <select class="form-select form-select-sm" id="min_rating" name="min_rating">
                                    <option value="">Toutes les notes</option>
                                    <option value="3" <?= ($_GET['min_rating'] ?? '') == '3' ? 'selected' : '' ?>>⭐ 3+</option>
                                    <option value="4" <?= ($_GET['min_rating'] ?? '') == '4' ? 'selected' : '' ?>>⭐ 4+</option>
                                    <option value="4.5" <?= ($_GET['min_rating'] ?? '') == '4.5' ? 'selected' : '' ?>>⭐ 4.5+</option>
                                </select>
                            </div>

                            <!-- Boutons -->
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-search btn-sm">
                                    <i class="bi bi-check2"></i> Appliquer les filtres
                                </button>
                                <a href="covoiturages.php?departure=<?= urlencode($_GET['departure'] ?? '') ?>&destination=<?= urlencode($_GET['destination'] ?? '') ?>&date=<?= urlencode($_GET['date'] ?? '') ?>" 
                                   class="btn btn-outline-secondary btn-sm">
                                    <i class="bi bi-x-circle"></i> Réinitialiser
                                </a>
                            </div>
                        </form>
                    </div>
                </aside>

                <!-- Colonne des résultats (droite) -->
                <div class="col-12 col-lg-9">
                    <div class="results-header mb-3 d-flex justify-content-between align-items-center">
                        <h2 class="h4 fw-bold mb-0">Trajets disponibles</h2>
                        <div class="results-count text-muted">
                            <small>
                                <?php
                                // Mettre le Php ici plus tard pour calculer les résultats
                                // Exemple : echo count($trajets) . ' résultat(s) trouvé(s)';
                                ?>
                                12 résultats trouvés
                            </small>
                        </div>
                    </div>

                    <!-- Listing des résultats de trajets disponibles -->
                    <div class="results-list">
                        <?php
                        // Mettre boucle PHP ici pour afficher les trajets ?
                        //Exemple : foreach ($trajets as $trajet) { ?>
                        
                        <!-- Exemple d'un trajet  -->
                        <div class="card mb-3 shadow-sm ride-card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-12 col-md-8">
                                        <div class="d-flex align-items-center mb-2">
                                            <img src="img/dupont.png" alt="Avatar" class="rounded-circle me-3" width="50" height="50">
                                            <div>
                                                <h5 class="mb-0">Jean D.</h5>
                                                <small class="text-muted">⭐ 4.8 (24 avis)</small>
                                            </div>
                                            <span class="badge bg-success ms-3">
                                                <i class="bi bi-ev-front"></i> Écologique
                                            </span>
                                        </div>
                                        <div class="ride-details">
                                            <p class="mb-1">
                                                <i class="bi bi-clock"></i> <strong>08:00</strong> Toulon → <strong>10:30</strong> Marseille
                                            </p>
                                            <p class="mb-0 text-muted small">
                                                <i class="bi bi-hourglass-split"></i> 2h30 • <i class="bi bi-person"></i> 2 places disponibles
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4 text-md-end mt-3 mt-md-0">
                                        <div class="price-section">
                                            <p class="h4 fw-bold mb-2">25 Crédits</p>
                                            <a href="trajet-details.php?id=1" class="btn btn-search btn-sm w-100">
                                                Voir le détail
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <?php 
                        // } // Fin de la boucle foreach ?
                        ?>

                        <!-- Message si aucun résultat -->
                        <?php if (false /* Remplacer par : empty($trajets) */) { ?>
                        <div class="card shadow-sm">
                            <div class="card-body text-center py-5">
                                <i class="bi bi-search display-1 text-muted mb-3"></i>
                                <h3 class="h5 text-muted">Aucun trajet trouvé</h3>
                                <p class="text-muted">Essayez de modifier vos critères de recherche</p>
                            </div>
                        </div>
                        <?php } ?>
                    </div>

                    <!-- Pagination -->
                    <nav aria-label="Pagination" class="mt-4">
                        <ul class="pagination justify-content-center">
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1">Précédent</a>
                            </li>
                            <li class="page-item active">
                                <a class="page-link" href="#">1</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#">2</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#">3</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#">Suivant</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </section>
</main>


<?php include __DIR__ . '/footer.phtml'; ?>